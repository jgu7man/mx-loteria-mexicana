<div
     class="player-container min-h-screen bg-gradient-to-br from-green-600 to-teal-700 p-4 md:p-6 xl:p-8">
  
  <!-- Podium overlay -->
  <app-podium
    *ngIf="showPodium() && !showMarkerSelector() && !showTablaSelector()"
    [winners]="currentRoundWinners()"
    [roundNumber]="room()?.currentRound || 0"
    [maxRounds]="room()?.config?.maxRounds || 0"
    [isLastRound]="room()?.state === 'finished'">
    
    <div class="flex flex-col sm:flex-row gap-3 justify-center">
      <button 
        (click)="showMarkerSelector.set(true)" 
        class="bg-white text-blue-800 px-6 py-3 rounded-xl font-bold hover:bg-blue-50 transition shadow-lg border-2 border-blue-600 flex items-center justify-center gap-2">
        <span>âœï¸</span> Cambiar Marcador
      </button>
      <button 
        (click)="showTablaSelector.set(true)" 
        class="bg-white text-indigo-800 px-6 py-3 rounded-xl font-bold hover:bg-indigo-50 transition shadow-lg border-2 border-indigo-600 flex items-center justify-center gap-2">
        <span>ğŸ“‹</span> Cambiar Tabla
      </button>
    </div>
  </app-podium>

  <!-- Join form -->
  <app-player-join-form
    *ngIf="showJoinForm()"
    [(displayName)]="displayName"
    [(roomId)]="roomId"
    (signInAnonymously)="signInAnonymously()"
    (signInWithGoogle)="signInWithGoogle()"
    (goHome)="goHome()">
  </app-player-join-form>

  <!-- Room Deleted Message -->
  <div *ngIf="isRoomDeleted() && !showJoinForm()" class="fixed inset-0 bg-gray-900/90 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl p-8 max-w-md w-full text-center shadow-2xl">
      <div class="text-6xl mb-4">ğŸš«</div>
      <h2 class="text-2xl font-bold text-gray-800 mb-2">Sala Eliminada</h2>
      <p class="text-gray-600 mb-6">
        El administrador ha cerrado o eliminado esta sala de juego.
      </p>
      <button 
        (click)="goHome()"
        class="w-full bg-indigo-600 text-white py-3 px-6 rounded-xl font-bold hover:bg-indigo-700 transition transform hover:scale-105 shadow-lg">
        ğŸ  Volver al Inicio
      </button>
    </div>
  </div>

  <!-- Marker selector -->
  <div *ngIf="showMarkerSelector()" class="max-w-2xl mx-auto">
    <div class="bg-white rounded-2xl shadow-2xl p-8">
      <div *ngIf="selectedMarker() || myTabla().length > 0" class="mb-4">
        <button
          (click)="cancelMarkerSelection()"
          class="bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-300 transition">
          â† Cancelar
        </button>
      </div>
      <app-marker (markerSelected)="onMarkerSelected($event)"></app-marker>
    </div>
  </div>

  <!-- Tabla selector -->
  <app-player-tabla-selector
    *ngIf="showTablaSelector()"
    [availableTablas]="availableTablas()"
    [showCancelButton]="myTabla().length > 0"
    (tablaSelected)="selectTabla($event)"
    (cancel)="cancelTablaSelection()"
    (requestMore)="refreshAvailableTablas()">
  </app-player-tabla-selector>

  <!-- Game view -->
  <app-player-game-board
    *ngIf="!isRoomDeleted() && !showJoinForm() && !showMarkerSelector() && !showTablaSelector()"
    [room]="room()"
    [currentCard]="currentCard()"
    [historyCards]="historyCards()"
    [myTabla]="myTabla()"
    [myMarks]="myMarks()"
    [selectedMarker]="selectedMarker()?.emoji || 'ğŸ«˜'"
    [roomId]="roomId"
    (cardClicked)="onCardClicked($event)"
    (shoutLoteria)="shoutLoteria()"
    (changeMarker)="showMarkerSelector.set(true)"
    (changeTabla)="showTablaSelector.set(true)"
    (goHome)="goHome()">
  </app-player-game-board>
</div>
